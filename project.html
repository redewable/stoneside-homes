<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project | Stoneside Custom Homes</title>
  <meta name="description" content="View this custom home built by Stoneside Custom Homes in Bryan-College Station, Texas." />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="css/extraordinary.css" />
  <link rel="icon" type="image/png" href="assets/images/favicon.png" />

  <style>
    /* ════════════════════════════════════════════════════════════════
       PROJECT PAGE STYLES
       ════════════════════════════════════════════════════════════════ */

    .project-page {
      min-height: 100vh;
      background: var(--charcoal);
    }

    /* Header */
    .project-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to bottom, rgba(26, 26, 24, 0.95), transparent);
      transition: background 0.3s ease;
    }

    .project-header.scrolled {
      background: rgba(26, 26, 24, 0.98);
      backdrop-filter: blur(10px);
    }

    .back-link {
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--stone);
      text-decoration: none;
      font-size: 0.875rem;
      font-weight: 500;
      letter-spacing: 0.02em;
      transition: color 0.3s ease;
    }

    .back-link:hover {
      color: var(--cream);
    }

    .back-link svg {
      width: 20px;
      height: 20px;
    }

    .project-nav {
      display: flex;
      gap: 12px;
    }

    .project-nav-btn {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 50%;
      color: var(--stone);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .project-nav-btn:hover:not(.disabled) {
      background: var(--bronze);
      border-color: var(--bronze);
      color: var(--charcoal);
    }

    .project-nav-btn.disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .project-nav-btn svg {
      width: 20px;
      height: 20px;
    }

    /* Hero Section */
    .project-hero {
      position: relative;
      height: 70vh;
      min-height: 500px;
      overflow: hidden;
    }

    .project-hero-media {
      position: absolute;
      inset: 0;
    }

    .project-hero-sketch,
    .project-hero-photo {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: opacity 0.8s ease;
    }

    .project-hero-sketch {
      opacity: 0.3;
      filter: grayscale(1);
    }

    .project-hero-photo {
      opacity: 1;
    }

    .project-hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to bottom,
        rgba(26, 26, 24, 0.3) 0%,
        rgba(26, 26, 24, 0.1) 40%,
        rgba(26, 26, 24, 0.7) 80%,
        rgba(26, 26, 24, 1) 100%
      );
    }

    .project-hero-content {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 60px;
      z-index: 2;
    }

    .project-type-badge {
      display: inline-block;
      padding: 6px 16px;
      background: var(--bronze);
      color: var(--charcoal);
      font-size: 0.625rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      border-radius: 100px;
      margin-bottom: 16px;
    }

    .project-title {
      font-family: var(--font-display);
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 400;
      color: var(--cream);
      line-height: 1.1;
      margin-bottom: 12px;
    }

    .project-location {
      font-size: 1rem;
      color: var(--stone);
      letter-spacing: 0.02em;
    }

    /* Gallery Section */
    .project-gallery {
      padding: 80px 60px;
      background: var(--charcoal);
    }

    .gallery-header {
      margin-bottom: 48px;
    }

    .gallery-title {
      font-family: var(--font-display);
      font-size: 1.75rem;
      font-weight: 400;
      color: var(--cream);
      margin-bottom: 8px;
    }

    .gallery-subtitle {
      font-size: 0.875rem;
      color: var(--stone);
      letter-spacing: 0.02em;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin-bottom: 48px;
    }

    @media (max-width: 768px) {
      .gallery-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .gallery-item {
      position: relative;
      aspect-ratio: 4/3;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border-subtle);
      transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .gallery-item:hover {
      transform: translateY(-4px);
      border-color: var(--bronze);
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }

    .gallery-item:hover img {
      transform: scale(1.05);
    }

    .gallery-item-label {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 16px 20px;
      background: linear-gradient(to top, rgba(26, 26, 24, 0.95), transparent);
      font-size: 0.875rem;
      color: var(--cream);
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .gallery-item:hover .gallery-item-label {
      opacity: 1;
    }

    /* Lightbox Styles */
    .lightbox-overlay {
      position: fixed;
      inset: 0;
      background: rgba(10, 10, 10, 0.95);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      padding: 40px 20px;
    }

    .lightbox-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .lightbox-container {
      position: relative;
      width: 100%;
      max-width: 1000px;
      max-height: 85vh;
      display: flex;
      flex-direction: column;
    }

    .lightbox-image-wrapper {
      position: relative;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .lightbox-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .lightbox-close {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      color: var(--cream);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 24px;
      line-height: 1;
    }

    .lightbox-close:hover {
      background: var(--bronze);
      border-color: var(--bronze);
      color: var(--charcoal);
    }

    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      color: var(--cream);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .lightbox-nav:hover {
      background: var(--bronze);
      border-color: var(--bronze);
      color: var(--charcoal);
    }

    .lightbox-nav.prev {
      left: 20px;
    }

    .lightbox-nav.next {
      right: 20px;
    }

    .lightbox-nav svg {
      width: 24px;
      height: 24px;
    }

    .lightbox-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      color: var(--cream);
      font-size: 0.875rem;
    }

    .lightbox-label {
      font-weight: 500;
    }

    .lightbox-counter {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      color: var(--stone);
    }

    /* Content Section */
    .project-content {
      padding: 80px 60px;
      max-width: 1400px;
      margin: 0 auto;
      background: var(--charcoal);
    }

    .project-grid {
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 80px;
    }

    @media (max-width: 1000px) {
      .project-grid {
        grid-template-columns: 1fr;
        gap: 60px;
      }
    }

    .project-main h2 {
      font-family: var(--font-display);
      font-size: 1.75rem;
      font-weight: 400;
      color: var(--cream);
      margin-bottom: 24px;
    }

    .project-description {
      font-size: 1.125rem;
      line-height: 1.8;
      color: var(--stone);
      margin-bottom: 48px;
    }

    .project-features {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin-bottom: 48px;
    }

    @media (max-width: 600px) {
      .project-features {
        grid-template-columns: 1fr;
      }
    }

    .feature-item {
      padding: 24px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
    }

    .feature-label {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--stone);
      margin-bottom: 8px;
    }

    .feature-value {
      font-family: var(--font-display);
      font-size: 1.5rem;
      color: var(--cream);
    }

    /* Sidebar */
    .project-sidebar {
      position: sticky;
      top: 120px;
    }

    .specs-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 32px;
    }

    .specs-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--bronze);
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-subtle);
    }

    .specs-list {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    @media (max-width: 480px) {
      .specs-list {
        grid-template-columns: 1fr;
        gap: 12px;
      }
    }

    .spec-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.04);
    }

    .spec-label {
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--stone);
    }

    .spec-value {
      font-family: var(--font-display);
      font-size: 1.25rem;
      color: var(--cream);
      font-weight: 400;
    }

    .verse-card {
      background: linear-gradient(135deg, rgba(157, 123, 90, 0.1), rgba(157, 123, 90, 0.05));
      border: 1px solid rgba(157, 123, 90, 0.2);
      border-radius: 16px;
      padding: 32px;
      text-align: center;
    }

    .verse-mark {
      font-family: var(--font-display);
      font-size: 3rem;
      color: var(--bronze);
      line-height: 1;
      margin-bottom: 12px;
    }

    .verse-text {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 1.125rem;
      color: var(--cream);
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .verse-ref {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--bronze);
    }

    /* CTA Section */
    .project-cta {
      margin-top: 48px;
      padding-top: 48px;
      border-top: 1px solid var(--border-subtle);
    }

    .cta-text {
      font-size: 1rem;
      color: var(--stone);
      margin-bottom: 24px;
    }

    .cta-btn {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      padding: 16px 32px;
      background: var(--bronze);
      color: var(--charcoal);
      font-size: 0.875rem;
      font-weight: 600;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .cta-btn:hover {
      background: var(--cream);
      transform: translateY(-2px);
    }

    .cta-btn svg {
      width: 18px;
      height: 18px;
    }

    /* Related Projects */
    .related-section {
      padding: 80px 60px;
      background: rgba(0, 0, 0, 0.2);
    }

    .related-header {
      text-align: center;
      margin-bottom: 48px;
    }

    .related-title {
      font-family: var(--font-display);
      font-size: 2rem;
      color: var(--cream);
    }

    .related-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      max-width: 1200px;
      margin: 0 auto;
    }

    @media (max-width: 900px) {
      .related-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 600px) {
      .related-grid {
        grid-template-columns: 1fr;
      }
    }

    .related-card {
      position: relative;
      aspect-ratio: 4/3;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .related-card:hover {
      transform: translateY(-4px);
    }

    .related-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .related-card:hover img {
      transform: scale(1.05);
    }

    .related-card-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(26, 26, 24, 0.9), transparent);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 24px;
    }

    .related-card-title {
      font-family: var(--font-display);
      font-size: 1.25rem;
      color: var(--cream);
      margin-bottom: 4px;
    }

    .related-card-meta {
      font-size: 0.75rem;
      color: var(--stone);
    }

    /* Footer */
    .project-footer {
      padding: 40px 60px;
      border-top: 1px solid var(--border-subtle);
      text-align: center;
    }

    .footer-text {
      font-size: 0.875rem;
      color: var(--stone);
    }

    /* Tablet Responsive */
    @media (max-width: 900px) {
      .project-gallery {
        padding: 60px 40px;
      }

      .project-content {
        padding: 60px 40px;
      }

      .related-section {
        padding: 60px 40px;
      }

      .project-hero {
        height: 55vh;
        min-height: 400px;
      }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .project-header {
        padding: 16px 20px;
      }

      .project-hero {
        height: 50vh;
        min-height: 350px;
      }

      .project-hero-content {
        padding: 32px 20px;
      }

      .project-title {
        font-size: clamp(1.75rem, 8vw, 2.5rem);
      }

      .project-gallery {
        padding: 40px 20px;
      }

      .gallery-grid {
        gap: 12px;
      }

      .project-content {
        padding: 40px 20px;
      }

      .project-description {
        font-size: 1rem;
      }

      .project-features {
        grid-template-columns: 1fr;
        gap: 16px;
      }

      .feature-item {
        padding: 20px;
      }

      .feature-value {
        font-size: 1.25rem;
      }

      .specs-card {
        padding: 24px;
      }

      .verse-card {
        padding: 24px;
      }

      .related-section {
        padding: 40px 20px;
      }

      .related-title {
        font-size: 1.5rem;
      }

      .project-footer {
        padding: 32px 20px;
      }

      .lightbox-overlay {
        padding: 20px 10px;
      }

      .lightbox-nav {
        width: 40px;
        height: 40px;
      }

      .lightbox-nav.prev {
        left: 8px;
      }

      .lightbox-nav.next {
        right: 8px;
      }

      .lightbox-info {
        padding: 0 10px;
        flex-direction: column;
        gap: 4px;
        text-align: center;
      }
    }

    /* Small Mobile */
    @media (max-width: 480px) {
      .project-hero {
        height: 45vh;
        min-height: 300px;
      }

      .project-type-badge {
        font-size: 0.5625rem;
        padding: 5px 12px;
      }

      .project-title {
        font-size: 1.5rem;
      }

      .project-location {
        font-size: 0.875rem;
      }

      .gallery-header {
        margin-bottom: 32px;
      }

      .gallery-title {
        font-size: 1.375rem;
      }

      .project-main h2 {
        font-size: 1.375rem;
      }

      .back-link span {
        display: none;
      }

      .project-nav-btn {
        width: 38px;
        height: 38px;
      }
    }

    /* Loading & Error States */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      font-size: 1rem;
      color: var(--stone);
    }

    .error-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      padding: 40px;
    }

    .error-state h1 {
      font-family: var(--font-display);
      font-size: 2rem;
      color: var(--cream);
      margin-bottom: 16px;
    }

    .error-state p {
      color: var(--stone);
      margin-bottom: 32px;
    }
  </style>
</head>

<body class="project-page">
  <!-- Loading State -->
  <div class="loading" id="loadingState">Loading project...</div>

  <!-- Error State -->
  <div class="error-state" id="errorState" style="display: none;">
    <h1>Project Not Found</h1>
    <p>The project you're looking for doesn't exist or has been removed.</p>
    <a href="home.html#portfolio" class="cta-btn">
      <span>View All Projects</span>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </a>
  </div>

  <!-- Main Content -->
  <div id="projectContent" style="display: none;">
    <!-- Header -->
    <header class="project-header" id="projectHeader">
      <a href="home.html#portfolio" class="back-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        <span>Back to Portfolio</span>
      </a>

      <div class="project-nav">
        <button class="project-nav-btn" id="prevProject" title="Previous Project">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <button class="project-nav-btn" id="nextProject" title="Next Project">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Hero -->
    <section class="project-hero">
      <div class="project-hero-media">
        <img class="project-hero-sketch" id="heroSketch" src="" alt="" />
        <img class="project-hero-photo" id="heroPhoto" src="" alt="" />
        <div class="project-hero-overlay"></div>
      </div>

      <div class="project-hero-content">
        <span class="project-type-badge" id="projectType">Custom Build</span>
        <h1 class="project-title" id="projectTitle">Loading...</h1>
        <p class="project-location" id="projectLocation">Location</p>
      </div>
    </section>

    <!-- Gallery Section -->
    <section class="project-gallery">
      <div class="gallery-header">
        <h2 class="gallery-title">Gallery</h2>
        <p class="gallery-subtitle">Click any image to view in fullscreen</p>
      </div>
      <div class="gallery-grid" id="galleryGrid">
        <!-- Populated by JavaScript -->
      </div>
    </section>

    <!-- Content -->
    <section class="project-content">
      <div class="project-grid">
        <div class="project-main">
          <h2>About This Home</h2>
          <p class="project-description" id="projectDescription">
            Loading project description...
          </p>

          <div class="project-features">
            <div class="feature-item">
              <div class="feature-label">Square Footage</div>
              <div class="feature-value" id="featureSqft">—</div>
            </div>
            <div class="feature-item">
              <div class="feature-label">Bedrooms</div>
              <div class="feature-value" id="featureBeds">—</div>
            </div>
            <div class="feature-item">
              <div class="feature-label">Bathrooms</div>
              <div class="feature-value" id="featureBaths">—</div>
            </div>
            <div class="feature-item">
              <div class="feature-label">Garage</div>
              <div class="feature-value" id="featureGarage">—</div>
            </div>
          </div>

          <div class="project-cta">
            <p class="cta-text">Interested in building a home like this? Let's start a conversation.</p>
            <a href="home.html#contact" class="cta-btn">
              <span>Start Your Project</span>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M7 17L17 7M17 7H7M17 7v10"/>
              </svg>
            </a>
          </div>
        </div>

        <aside class="project-sidebar">
          <div class="specs-card">
            <h3 class="specs-title">Project Specifications</h3>
            <div class="specs-list">
              <div class="spec-row">
                <span class="spec-label">Type</span>
                <span class="spec-value" id="specType">Custom Build</span>
              </div>
              <div class="spec-row">
                <span class="spec-label">Location</span>
                <span class="spec-value" id="specLocation">—</span>
              </div>
              <div class="spec-row">
                <span class="spec-label">Size</span>
                <span class="spec-value" id="specSize">—</span>
              </div>
              <div class="spec-row">
                <span class="spec-label">Beds / Baths</span>
                <span class="spec-value" id="specBedBath">—</span>
              </div>
              <div class="spec-row">
                <span class="spec-label">Garage</span>
                <span class="spec-value" id="specGarage">—</span>
              </div>
              <div class="spec-row">
                <span class="spec-label">Completed</span>
                <span class="spec-value" id="specYear">—</span>
              </div>
            </div>
          </div>

          <div class="verse-card" id="verseCard">
            <div class="verse-mark">"</div>
            <p class="verse-text" id="verseText">Loading...</p>
            <span class="verse-ref" id="verseRef">—</span>
          </div>
        </aside>
      </div>
    </section>

    <!-- Related Projects -->
    <section class="related-section">
      <div class="related-header">
        <h2 class="related-title">More Projects</h2>
      </div>
      <div class="related-grid" id="relatedGrid">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- Footer -->
    <footer class="project-footer">
      <p class="footer-text">© 2026 Stoneside Custom Homes · Bryan–College Station, Texas · Building Legacy Since 1984</p>
    </footer>
  </div>

  <!-- Lightbox -->
  <div class="lightbox-overlay" id="lightbox">
    <div class="lightbox-container">
      <div class="lightbox-image-wrapper">
        <img class="lightbox-image" id="lightboxImage" src="" alt="" />
        <button class="lightbox-close" id="lightboxClose">✕</button>
        <button class="lightbox-nav prev" id="lightboxPrev">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <button class="lightbox-nav next" id="lightboxNext">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
      </div>
      <div class="lightbox-info">
        <span class="lightbox-label" id="lightboxLabel">Image</span>
        <span class="lightbox-counter"><span id="lightboxCurrent">1</span> / <span id="lightboxTotal">1</span></span>
      </div>
    </div>
  </div>

  <!-- Load data and project script -->
  <script src="js/data.js"></script>
  <script>
    // ════════════════════════════════════════════════════════════════
    // PROJECT PAGE JAVASCRIPT
    // ════════════════════════════════════════════════════════════════

    let projects = [];
    let currentProject = null;
    let currentIndex = -1;
    let galleryImages = [];
    let lightboxIndex = -1;

    document.addEventListener('DOMContentLoaded', () => {
      loadProjects();
      initLightbox();
    });

    function getDefaultProjects() {
      return [
        { id: 1, title: "The Brandon", model: "brandon", type: "spec", location: "Grand Lake · Snook, Texas", sqft: "1,625", beds: "4", baths: "2", garage: "2 Car", year: "2025", photo: "assets/images/projects/brandon-569/brandon-exterior-main.jpg", sketch: "assets/images/projects/brandon-569/brandon-interior-main.jpg", description: "The Brandon model features a clean, modern farmhouse exterior with an open-concept interior. White cabinetry, granite counters, and dark hardwood floors create a crisp, timeless finish throughout.", verseText: "By wisdom a house is built, and through understanding it is established.", verseRef: "Proverbs 24:3", gallery: [{ src: "assets/images/projects/brandon-569/brandon-exterior-main.jpg", label: "Front Exterior" }, { src: "assets/images/projects/brandon-569/brandon-entry.jpg", label: "Entry" }, { src: "assets/images/projects/brandon-569/brandon-interior-main.jpg", label: "Living Area" }, { src: "assets/images/projects/brandon-569/brandon-kitchen.jpg", label: "Kitchen" }, { src: "assets/images/projects/brandon-569/brandon-master-bedroom.jpg", label: "Master Bedroom" }] },
        { id: 2, title: "The Bayley", model: "bayley", type: "spec", location: "Grand Lake · Snook, Texas", sqft: "1,749", beds: "3", baths: "2", garage: "2 Car", year: "2025", photo: "assets/images/projects/bayley-581/bayley-exterior-main.jpg", sketch: "assets/images/projects/bayley-581/bayley-interior-main.jpg", description: "The Bayley model delivers charm and efficiency in a compact footprint. Warm wood floors, a bright open kitchen, and thoughtful storage make this home feel larger than its square footage suggests.", verseText: "Unless the Lord builds the house, the builders labor in vain.", verseRef: "Psalm 127:1", gallery: [{ src: "assets/images/projects/bayley-581/bayley-exterior-main.jpg", label: "Front Exterior" }, { src: "assets/images/projects/bayley-581/bayley-interior-main.jpg", label: "Living Area" }, { src: "assets/images/projects/bayley-581/bayley-kitchen-1.jpg", label: "Kitchen" }] },
        { id: 3, title: "The Dustin", model: "dustin", type: "spec", location: "Grand Lake · Snook, Texas", sqft: "1,710", beds: "3", baths: "2", garage: "2 Car", year: "2025", photo: "assets/images/projects/dustin-557/dustin-557-exterior-main.jpg", sketch: "assets/images/projects/dustin-557/dustin-557-interior-main.jpg", description: "The Dustin model at Harvest Lake features generous living spaces, clean finishes, and a layout designed for growing families. Situated on a corner lot with views of the community pond.", verseText: "Commit your work to the Lord, and your plans will be established.", verseRef: "Proverbs 16:3", gallery: [{ src: "assets/images/projects/dustin-557/dustin-557-exterior-main.jpg", label: "Front Exterior" }, { src: "assets/images/projects/dustin-557/dustin-557-interior-main.jpg", label: "Living Area" }] },
      ];
    }

    function loadProjects() {
      // Try to load from STONESIDE_DATA (from data.js), fallback to defaults
      if (window.STONESIDE_DATA && window.STONESIDE_DATA.projects) {
        projects = window.STONESIDE_DATA.projects;
      } else {
        projects = getDefaultProjects();
      }

      // Get project ID from URL
      const urlParams = new URLSearchParams(window.location.search);
      const projectId = parseInt(urlParams.get('id'));

      if (!projectId) {
        showError();
        return;
      }

      // Find project
      currentIndex = projects.findIndex(p => p.id === projectId);
      currentProject = projects[currentIndex];

      if (!currentProject) {
        showError();
        return;
      }

      // Display project
      displayProject();
    }

    function showError() {
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'flex';
    }

    function displayProject() {
      const p = currentProject;

      // Update page title
      document.title = `${p.title} | Stoneside Custom Homes`;

      // Hero
      document.getElementById('heroSketch').src = p.sketch || p.photo || 'assets/images/hero-sketch.jpg';
      document.getElementById('heroPhoto').src = p.photo || 'assets/images/custom_home.jpg';
      document.getElementById('projectType').textContent = p.type === 'custom' ? 'Custom Build' : 'Spec Home';
      document.getElementById('projectTitle').textContent = p.title;
      document.getElementById('projectLocation').textContent = p.location;

      // Description
      document.getElementById('projectDescription').textContent = p.description || 'A beautiful custom home built with care and attention to detail by Stoneside Custom Homes.';

      // Features
      document.getElementById('featureSqft').textContent = p.sqft ? `${p.sqft} sq ft` : '—';
      document.getElementById('featureBeds').textContent = p.beds || '—';
      document.getElementById('featureBaths').textContent = p.baths || '—';
      document.getElementById('featureGarage').textContent = p.garage || '—';

      // Specs sidebar
      document.getElementById('specType').textContent = p.type === 'custom' ? 'Custom Build' : 'Spec Home';
      document.getElementById('specLocation').textContent = p.location || '—';
      document.getElementById('specSize').textContent = p.sqft ? `${p.sqft} sq ft` : '—';
      document.getElementById('specBedBath').textContent = `${p.beds || '—'} / ${p.baths || '—'}`;
      document.getElementById('specGarage').textContent = p.garage || '—';
      document.getElementById('specYear').textContent = p.year || '—';

      // Verse
      const verseCard = document.getElementById('verseCard');
      if (p.verseText) {
        document.getElementById('verseText').textContent = p.verseText;
        document.getElementById('verseRef').textContent = p.verseRef || '';
        verseCard.style.display = 'block';
      } else {
        verseCard.style.display = 'none';
      }

      // Gallery
      displayGallery();

      // Navigation
      updateNavigation();

      // Related projects
      displayRelatedProjects();

      // Show content
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('projectContent').style.display = 'block';

      // Initialize header scroll
      initHeaderScroll();
    }

    function displayGallery() {
      const gallery = currentProject.gallery || [];
      const grid = document.getElementById('galleryGrid');

      galleryImages = gallery;

      grid.innerHTML = gallery.map((item, index) => `
        <div class="gallery-item" data-index="${index}">
          <img src="${item.src}" alt="${item.label}" loading="lazy" />
          <div class="gallery-item-label">${item.label}</div>
        </div>
      `).join('');

      // Add click handlers
      grid.querySelectorAll('.gallery-item').forEach(item => {
        item.addEventListener('click', (e) => {
          openLightbox(parseInt(item.dataset.index));
        });
      });
    }

    function updateNavigation() {
      const prevBtn = document.getElementById('prevProject');
      const nextBtn = document.getElementById('nextProject');

      if (currentIndex <= 0) {
        prevBtn.classList.add('disabled');
        prevBtn.onclick = null;
      } else {
        prevBtn.classList.remove('disabled');
        prevBtn.onclick = () => navigateTo(currentIndex - 1);
      }

      if (currentIndex >= projects.length - 1) {
        nextBtn.classList.add('disabled');
        nextBtn.onclick = null;
      } else {
        nextBtn.classList.remove('disabled');
        nextBtn.onclick = () => navigateTo(currentIndex + 1);
      }
    }

    function navigateTo(index) {
      const project = projects[index];
      if (project) {
        window.location.href = `project.html?id=${project.id}`;
      }
    }

    function displayRelatedProjects() {
      const grid = document.getElementById('relatedGrid');

      // Get other projects (excluding current)
      const otherProjects = projects.filter(p => p.id !== currentProject.id);

      // Show up to 3 related projects
      const related = otherProjects.slice(0, 3);

      grid.innerHTML = related.map(p => `
        <a href="project.html?id=${p.id}" class="related-card">
          <img src="${p.photo || 'assets/images/custom_home.jpg'}" alt="${p.title}" />
          <div class="related-card-overlay">
            <h3 class="related-card-title">${p.title}</h3>
            <p class="related-card-meta">${p.location} · ${p.year}</p>
          </div>
        </a>
      `).join('');
    }

    function initHeaderScroll() {
      const header = document.getElementById('projectHeader');

      window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      }, { passive: true });
    }

    // ════════════════════════════════════════════════════════════════
    // LIGHTBOX FUNCTIONS
    // ════════════════════════════════════════════════════════════════

    function initLightbox() {
      const lightbox = document.getElementById('lightbox');
      const close = document.getElementById('lightboxClose');
      const prev = document.getElementById('lightboxPrev');
      const next = document.getElementById('lightboxNext');

      close.addEventListener('click', closeLightbox);
      prev.addEventListener('click', () => showPrevImage());
      next.addEventListener('click', () => showNextImage());

      // Close on overlay click
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          closeLightbox();
        }
      });

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (lightbox.classList.contains('active')) {
          if (e.key === 'ArrowLeft') showPrevImage();
          if (e.key === 'ArrowRight') showNextImage();
          if (e.key === 'Escape') closeLightbox();
        }
      });
    }

    function openLightbox(index) {
      lightboxIndex = index;
      const lightbox = document.getElementById('lightbox');
      updateLightboxImage();
      lightbox.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      const lightbox = document.getElementById('lightbox');
      lightbox.classList.remove('active');
      document.body.style.overflow = '';
      lightboxIndex = -1;
    }

    function updateLightboxImage() {
      if (lightboxIndex < 0 || lightboxIndex >= galleryImages.length) return;

      const image = galleryImages[lightboxIndex];
      document.getElementById('lightboxImage').src = image.src;
      document.getElementById('lightboxLabel').textContent = image.label;
      document.getElementById('lightboxCurrent').textContent = lightboxIndex + 1;
      document.getElementById('lightboxTotal').textContent = galleryImages.length;
    }

    function showNextImage() {
      if (lightboxIndex < galleryImages.length - 1) {
        lightboxIndex++;
        updateLightboxImage();
      }
    }

    function showPrevImage() {
      if (lightboxIndex > 0) {
        lightboxIndex--;
        updateLightboxImage();
      }
    }

    // Keyboard navigation for project browsing
    document.addEventListener('keydown', (e) => {
      const lightbox = document.getElementById('lightbox');
      if (!lightbox.classList.contains('active')) {
        if (e.key === 'ArrowLeft' && currentIndex > 0) {
          navigateTo(currentIndex - 1);
        } else if (e.key === 'ArrowRight' && currentIndex < projects.length - 1) {
          navigateTo(currentIndex + 1);
        }
      }
    });
  </script>
</body>
</html>
